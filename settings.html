<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Barcode Scan Application">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <meta name="theme-color" content="#0134d4">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <!-- Title -->
  <title>Barcode Scan App</title>

  <!-- Favicon -->
  <link rel="icon" href="img/core-img/favicon.ico">
  <link rel="apple-touch-icon" href="img/icons/icon-96x96.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="img/icons/icon-167x167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/icons/icon-180x180.png">

  <!-- Style CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- Web App Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="spinner-grow text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Internet Connection Status -->
  <div class="internet-connection-status" id="internetStatus"></div>

  <!-- Header Area -->
  <div class="header-area" id="headerArea">
    <div class="container">
      <!-- Header Content -->
      <div class="header-content header-style-five position-relative d-flex align-items-center justify-content-between">
        <!-- Logo Wrapper -->
        <div class="logo-wrapper">
          <a href="home.html">
            <img src="img/core-img/logo.png" alt="">
          </a>
        </div>

        <!-- Navbar Toggler -->
        <div class="navbar--toggler" id="affanNavbarToggler" data-bs-toggle="offcanvas" data-bs-target="#affanOffcanvas"
          aria-controls="affanOffcanvas">
          <span class="d-block"></span>
          <span class="d-block"></span>
          <span class="d-block"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- # Sidenav Left -->
  <div class="offcanvas offcanvas-start" id="affanOffcanvas" data-bs-scroll="true" tabindex="-1"
    aria-labelledby="affanOffcanvsLabel">

    <button class="btn-close btn-close-white text-reset" type="button" data-bs-dismiss="offcanvas"
      aria-label="Close"></button>

    <div class="offcanvas-body p-0">
      <div class="sidenav-wrapper">
        <!-- Sidenav Profile -->
        <div class="sidenav-profile bg-gradient">
          <div class="sidenav-style1"></div>

          <!-- User Thumbnail -->
          <div class="user-profile">
            <img src="img/bg-img/2.jpg" alt="">
          </div>

          <!-- User Info -->
          <div class="user-info">
            <h6 class="user-name mb-0">Shop Owner</h6>
            <span>Barcode Scan App</span>
          </div>
        </div>

        <!-- Sidenav Nav -->
        <ul class="sidenav-nav ps-0">
          <li>
            <a href="home.html"><i class="bi bi-house-door"></i> Home</a>
          </li>
          <li>
            <a href="scans.html"><i class="bi bi-upc-scan"></i> Scans</a>
          </li>
          <li>
            <a href="history.html"><i class="bi bi-list-ul"></i> Scan History</a>
          </li>
          <li>
            <a href="settings.html"><i class="bi bi-gear"></i> Settings</a>
          </li>
          <li>
            <div class="night-mode-nav">
              <i class="bi bi-moon"></i> Night Mode
              <div class="form-check form-switch">
                <input class="form-check-input form-check-success" id="darkSwitch" type="checkbox">
              </div>
            </div>
          </li>
          <li>
            <a href="login.html"><i class="bi bi-box-arrow-right"></i> Logout</a>
          </li>
        </ul>

        <!-- Social Info -->
        <div class="social-info-wrap">
          <a href="#">
            <i class="bi bi-facebook"></i>
          </a>
          <a href="#">
            <i class="bi bi-twitter"></i>
          </a>
          <a href="#">
            <i class="bi bi-linkedin"></i>
          </a>
        </div>

        <!-- Copyright Info -->
        <div class="copyright-info">
          <p>
            <span id="copyrightYear"></span>
            &copy; Barcode Scan App
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="page-content-wrapper">
    <div class="container">
      <div class="d-flex flex-column align-items-center justify-content-center vh-100 gap-3">
        <!-- Customer Button -->
        <button class="btn btn-primary btn-lg" onclick="openScanner('customer')">
          <i class="bi bi-upc-scan"></i> Customer Scan
        </button>
        <!-- Shop Owner Button -->
        <button class="btn btn-success btn-lg" onclick="openScanner('owner')">
          <i class="bi bi-upc-scan"></i> Shop Owner Scan
        </button>
        <!-- Torch Button -->
        <button id="torchButton" class="btn btn-secondary btn-lg" disabled>
          <i class="bi bi-lightbulb"></i> Turn On Torch
        </button>
      </div>
    </div>
  </div>

  <!-- Footer Nav -->
  <div class="footer-nav-area" id="footerNav">
    <div class="container px-0">
      <!-- Footer Content -->
      <div class="footer-nav position-relative">
        <ul class="h-100 d-flex align-items-center justify-content-between ps-0">
          <li class="active">
            <a href="home.html">
              <i class="bi bi-house"></i>
              <span>Home</span>
            </a>
          </li>

          <li>
            <a href="scans.html">
              <i class="bi bi-upc-scan"></i>
              <span>Scans</span>
            </a>
          </li>

          <li>
            <a href="history.html">
              <i class="bi bi-list-ul"></i>
              <span>History</span>
            </a>
          </li>

          <li>
            <a href="settings.html">
              <i class="bi bi-gear"></i>
              <span>Settings</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- All JavaScript Files -->
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/slideToggle.min.js"></script>
  <script src="js/internet-status.js"></script>
  <script src="js/tiny-slider.js"></script>
  <script src="js/venobox.min.js"></script>
  <script src="js/countdown.js"></script>
  <script src="js/rangeslider.min.js"></script>
  <script src="js/vanilla-dataTables.min.js"></script>
  <script src="js/index.js"></script>
  <script src="js/imagesloaded.pkgd.min.js"></script>
  <script src="js/isotope.pkgd.min.js"></script>
  <script src="js/dark-rtl.js"></script>
  <script src="js/active.js"></script>
  <!-- <script src="js/pwa.js"></script> -->

  <script>
    // Torch functionality
    let torchStatus = false;
    let currentStream = null;
    const torchButton = document.getElementById('torchButton');

    // Check for flashlight support
    if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
      navigator.mediaDevices.enumerateDevices().then(devices => {
        const flashlight = devices.find(device => device.kind === 'videoinput');
        if (flashlight) {
          torchButton.disabled = false;
        }
      });
    }

    torchButton.addEventListener('click', function () {
      if (torchStatus) {
        turnOffTorch();
      } else {
        turnOnTorch();
      }
    });

    function turnOnTorch() {
      navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
        .then(stream => {
          const track = stream.getVideoTracks()[0];
          const capabilities = track.getCapabilities();
          if (capabilities.torch) {
            track.applyConstraints({ advanced: [{ torch: true }] });
          }
          currentStream = stream;
          torchStatus = true;
          torchButton.textContent = "Turn Off Torch";
          torchButton.classList.remove('btn-secondary');
          torchButton.classList.add('btn-warning');
        }).catch(error => {
          alert("Error accessing the camera.");
        });
    }

    function turnOffTorch() {
      if (currentStream) {
        const track = currentStream.getVideoTracks()[0];
        track.applyConstraints({ advanced: [{ torch: false }] })
          .then(() => {
            currentStream.getTracks().forEach(track => track.stop()); // Stop all tracks
            currentStream = null;
            torchStatus = false;
            torchButton.textContent = "Turn On Torch";
            torchButton.classList.remove('btn-warning');
            torchButton.classList.add('btn-secondary');
          })
          .catch(error => {
            alert("Error turning off the torch.");
          });
      }
    }

    // Scanner functionality
    function openScanner(userType) {
      if (userType === 'customer') {
        alert("Customer Scan: Read price only.");
        // Add logic for customer barcode scanning
      } else if (userType === 'owner') {
        alert("Shop Owner Scan: Add or update price.");
        // Add logic for shop owner barcode scanning
      }
    }
  </script>
</body>

</html>
